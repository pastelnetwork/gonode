// Code generated by goa v3.15.0, DO NOT EDIT.
//
// StorageChallenge service
//
// Command:
// $ goa gen github.com/pastelnetwork/gonode/walletnode/api/design

package storagechallenge

import (
	"context"

	storagechallengeviews "github.com/pastelnetwork/gonode/walletnode/api/gen/storage_challenge/views"
	goa "goa.design/goa/v3/pkg"
	"goa.design/goa/v3/security"
)

// Storage Challenge service for to return storage-challenge related data
type Service interface {
	// Fetches summary stats data over a specified time range
	GetSummaryStats(context.Context, *GetSummaryStatsPayload) (res *SummaryStatsResult, err error)
	// Fetches storage-challenge reports
	GetDetailedLogs(context.Context, *GetDetailedLogsPayload) (res []*StorageMessage, err error)
}

// Auther defines the authorization functions to be implemented by the service.
type Auther interface {
	// APIKeyAuth implements the authorization logic for the APIKey security scheme.
	APIKeyAuth(ctx context.Context, key string, schema *security.APIKeyScheme) (context.Context, error)
}

// APIName is the name of the API as defined in the design.
const APIName = "walletnode"

// APIVersion is the version of the API as defined in the design.
const APIVersion = "1.0"

// ServiceName is the name of the service as defined in the design. This is the
// same value that is set in the endpoint request contexts under the ServiceKey
// key.
const ServiceName = "StorageChallenge"

// MethodNames lists the service method names as defined in the design. These
// are the same values that are set in the endpoint request contexts under the
// MethodKey key.
var MethodNames = [2]string{"getSummaryStats", "getDetailedLogs"}

// Data of challenge
type ChallengeData struct {
	// Block
	Block *int32
	// Merkelroot
	Merkelroot *string
	// Timestamp
	Timestamp string
	// File hash
	FileHash string
	// Start index
	StartIndex int
	// End index
	EndIndex int
}

// Data of evaluation
type EvaluationData struct {
	// Block
	Block *int32
	// Merkelroot
	Merkelroot *string
	// Timestamp
	Timestamp string
	// Hash
	Hash string
	// IsVerified
	IsVerified bool
}

// GetDetailedLogsPayload is the payload type of the StorageChallenge service
// getDetailedLogs method.
type GetDetailedLogsPayload struct {
	// PastelID of the user to fetch storage-challenge reports for
	Pid string
	// ChallengeID of the storage challenge to fetch their logs
	ChallengeID *string
	// Passphrase of the owner's PastelID
	Key string
}

// GetSummaryStatsPayload is the payload type of the StorageChallenge service
// getSummaryStats method.
type GetSummaryStatsPayload struct {
	// Start time for the metrics data range
	From *string
	// End time for the metrics data range
	To *string
	// PastelID of the user to fetch metrics for
	Pid string
	// Passphrase of the owner's PastelID
	Key string
}

// Data of Observer's evaluation
type ObserverEvaluationData struct {
	// Block
	Block *int32
	// Merkelroot
	Merkelroot *string
	// IsChallengeTimestampOK
	IsChallengeTimestampOK bool
	// IsProcessTimestampOK
	IsProcessTimestampOK bool
	// IsEvaluationTimestampOK
	IsEvaluationTimestampOK bool
	// IsRecipientSignatureOK
	IsRecipientSignatureOK bool
	// IsChallengerSignatureOK
	IsChallengerSignatureOK bool
	// IsEvaluationResultOK
	IsEvaluationResultOK bool
	// Reason
	Reason *string
	// TrueHash
	TrueHash string
	// Timestamp
	Timestamp string
}

// Data of response
type ResponseData struct {
	// Block
	Block *int32
	// Merkelroot
	Merkelroot *string
	// Hash
	Hash *string
	// Timestamp
	Timestamp string
}

// Storage-Challenge SummaryStats
type SCSummaryStats struct {
	// Total number of challenges issued
	TotalChallengesIssued int
	// Total number of challenges processed by the recipient node
	TotalChallengesProcessedByRecipient int
	// Total number of challenges evaluated by the challenger node
	TotalChallengesEvaluatedByChallenger int
	// Total number of challenges verified by observers
	TotalChallengesVerified int
	// challenges failed due to slow-responses evaluated by observers
	NoOfSlowResponsesObservedByObservers int
	// challenges failed due to invalid signatures evaluated by observers
	NoOfInvalidSignaturesObservedByObservers int
	// challenges failed due to invalid evaluation evaluated by observers
	NoOfInvalidEvaluationObservedByObservers int
}

// Storage challenge message data
type StorageMessage struct {
	// ID of the challenge
	ChallengeID string
	// type of the message
	MessageType string
	// ID of the sender's node
	SenderID string
	// signature of the sender
	SenderSignature *string
	// ID of the challenger
	ChallengerID string
	// Challenge data
	Challenge *ChallengeData
	// List of observer IDs
	Observers []string
	// ID of the recipient
	RecipientID string
	// Response data
	Response *ResponseData
	// Challenger evaluation data
	ChallengerEvaluation *EvaluationData
	// Observer evaluation data
	ObserverEvaluation *ObserverEvaluationData
}

// SummaryStatsResult is the result type of the StorageChallenge service
// getSummaryStats method.
type SummaryStatsResult struct {
	// SCSummaryStats represents storage challenge summary of metrics stats
	ScSummaryStats *SCSummaryStats
}

// MakeUnauthorized builds a goa.ServiceError from an error.
func MakeUnauthorized(err error) *goa.ServiceError {
	return goa.NewServiceError(err, "Unauthorized", false, false, false)
}

// MakeBadRequest builds a goa.ServiceError from an error.
func MakeBadRequest(err error) *goa.ServiceError {
	return goa.NewServiceError(err, "BadRequest", false, false, false)
}

// MakeNotFound builds a goa.ServiceError from an error.
func MakeNotFound(err error) *goa.ServiceError {
	return goa.NewServiceError(err, "NotFound", false, false, false)
}

// MakeInternalServerError builds a goa.ServiceError from an error.
func MakeInternalServerError(err error) *goa.ServiceError {
	return goa.NewServiceError(err, "InternalServerError", false, false, false)
}

// NewSummaryStatsResult initializes result type SummaryStatsResult from viewed
// result type SummaryStatsResult.
func NewSummaryStatsResult(vres *storagechallengeviews.SummaryStatsResult) *SummaryStatsResult {
	return newSummaryStatsResult(vres.Projected)
}

// NewViewedSummaryStatsResult initializes viewed result type
// SummaryStatsResult from result type SummaryStatsResult using the given view.
func NewViewedSummaryStatsResult(res *SummaryStatsResult, view string) *storagechallengeviews.SummaryStatsResult {
	p := newSummaryStatsResultView(res)
	return &storagechallengeviews.SummaryStatsResult{Projected: p, View: "default"}
}

// newSummaryStatsResult converts projected type SummaryStatsResult to service
// type SummaryStatsResult.
func newSummaryStatsResult(vres *storagechallengeviews.SummaryStatsResultView) *SummaryStatsResult {
	res := &SummaryStatsResult{}
	if vres.ScSummaryStats != nil {
		res.ScSummaryStats = transformStoragechallengeviewsSCSummaryStatsViewToSCSummaryStats(vres.ScSummaryStats)
	}
	return res
}

// newSummaryStatsResultView projects result type SummaryStatsResult to
// projected type SummaryStatsResultView using the "default" view.
func newSummaryStatsResultView(res *SummaryStatsResult) *storagechallengeviews.SummaryStatsResultView {
	vres := &storagechallengeviews.SummaryStatsResultView{}
	if res.ScSummaryStats != nil {
		vres.ScSummaryStats = transformSCSummaryStatsToStoragechallengeviewsSCSummaryStatsView(res.ScSummaryStats)
	}
	return vres
}

// transformStoragechallengeviewsSCSummaryStatsViewToSCSummaryStats builds a
// value of type *SCSummaryStats from a value of type
// *storagechallengeviews.SCSummaryStatsView.
func transformStoragechallengeviewsSCSummaryStatsViewToSCSummaryStats(v *storagechallengeviews.SCSummaryStatsView) *SCSummaryStats {
	if v == nil {
		return nil
	}
	res := &SCSummaryStats{
		TotalChallengesIssued:                    *v.TotalChallengesIssued,
		TotalChallengesProcessedByRecipient:      *v.TotalChallengesProcessedByRecipient,
		TotalChallengesEvaluatedByChallenger:     *v.TotalChallengesEvaluatedByChallenger,
		TotalChallengesVerified:                  *v.TotalChallengesVerified,
		NoOfSlowResponsesObservedByObservers:     *v.NoOfSlowResponsesObservedByObservers,
		NoOfInvalidSignaturesObservedByObservers: *v.NoOfInvalidSignaturesObservedByObservers,
		NoOfInvalidEvaluationObservedByObservers: *v.NoOfInvalidEvaluationObservedByObservers,
	}

	return res
}

// transformSCSummaryStatsToStoragechallengeviewsSCSummaryStatsView builds a
// value of type *storagechallengeviews.SCSummaryStatsView from a value of type
// *SCSummaryStats.
func transformSCSummaryStatsToStoragechallengeviewsSCSummaryStatsView(v *SCSummaryStats) *storagechallengeviews.SCSummaryStatsView {
	res := &storagechallengeviews.SCSummaryStatsView{
		TotalChallengesIssued:                    &v.TotalChallengesIssued,
		TotalChallengesProcessedByRecipient:      &v.TotalChallengesProcessedByRecipient,
		TotalChallengesEvaluatedByChallenger:     &v.TotalChallengesEvaluatedByChallenger,
		TotalChallengesVerified:                  &v.TotalChallengesVerified,
		NoOfSlowResponsesObservedByObservers:     &v.NoOfSlowResponsesObservedByObservers,
		NoOfInvalidSignaturesObservedByObservers: &v.NoOfInvalidSignaturesObservedByObservers,
		NoOfInvalidEvaluationObservedByObservers: &v.NoOfInvalidEvaluationObservedByObservers,
	}

	return res
}
